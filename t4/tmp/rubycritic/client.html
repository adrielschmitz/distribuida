<!DOCTYPE html>
<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ruby Critic - Home</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- StyleSheets -->
    <link href="assets/stylesheets/bootstrap.min.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="assets/stylesheets/font-awesome.min.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="assets/stylesheets/prettify.custom_theme.css" media="screen, projection, print" rel="stylesheet" type="text/css">
    <link href="assets/stylesheets/application.css" media="screen, projection, print" rel="stylesheet" type="text/css">
  </head>

  <body>
    <header class="navbar navbar-default navbar-fixed-top">
      <a href="#menu-toggle" class="btn btn-default hidden-lg visible-sm-* hidden-md visible-xs-* pull-left" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a>
      <a href="overview.html"><img src="assets/images/logo.png" title="Ruby Critic Logo" width="55"><span class="logo">RUBYCRITIC</span></a>
      
    </header>
    <div id="wrapper">
      <!-- Sidebar -->
      <aside id="sidebar-wrapper">
        <ul class="sidebar-nav">
          <li class="sidebar-item">
            <a href="overview.html" class="project-nav-item overview-nav"><i class="fa fa-dashboard"></i>Overview</a>
          </li>
          <li class="sidebar-item">
            <a href="code_index.html" class="project-nav-item code-index-nav"><i class="fa fa-code"></i>Code</a>
          </li>
          <li class="sidebar-item">
            <a href="smells_index.html" class="project-nav-item smells-index-nav"><i class="fa fa-warning"></i>Smells</a>
          </li>
        </ul>
      </aside>
      <!-- /#sidebar-wrapper -->
      <div id="page-content-wrapper">
        <div class="container-fluid">
          <div class="row">
  <!--Page Title -->
  <div class="Page_Title">
    <div class="file-time">
      <span class="committed-at">
        
          Updated <time class='js-timeago' datetime='2019-05-27 21:47:09 -0300'>2019-05-27 21:47:09 -0300</time>
        
      </span>
    </div>
    <div>
      <h3><small>. /</small> client.rb</h3>
    </div>
  </div>
  <!--End Page Title -->
  <div class="Content_Wrapper">
    <!-- code detail -->
    <div class="code-top-detail clearfix row">
      <div class="col-md-8">
        <div class="row">
          <div class="col-md-1">
            <div class="rating d big">
              D
            </div>
          </div>
          <div class="code-statistics col-md-11">
            <div class="col-md-3">
              <div><span class="metric">225</span><small> lines of codes</small></div>
              <div><span class="metric">15</span><small> methods</small></div>
            </div>
            <div class="col-md-3">
              <div><span class="metric">14.5</span><small> complexity/method</small></div>
              <div><span class="metric">21</span><small> churn</small></div>
            </div>
            <div class="col-md-3">
              <div><span class="metric">217.58</span><small> complexity</small></div>
              <div><span class="metric">0</span><small> duplications</small></div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="code-tabs">
          <ul class="nav nav-pills right-to-left">
            <li><a href="#" id="toggle-code" class="toggle-button button">code</a></li>
            <li class="active">
              <a href="#" id="toggle-smells" class="toggle-button button">
                29
                smells
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <code class="prettyprint linenums lang-ruby file-code js-file-code"># Trabalho 04 | Distributed Hash Table
# Alunos: Adriel Schmitz, Leonardo Werlang
# Professor: Braulio Adriano de Melo
# Disciplina: Computacao Distribuida

require &#39;socket&#39;
require &#39;./read_config&#39;
require &#39;./routing_table&#39;

module Router
  # Classe responsavel por toda configuracao do cliente
  class Client<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Instance-Variable-Assumption.md" target="_blank"><b>InstanceVariableAssumption</b></a>        </span>      </div>      <span>Router::Client assumes too much for instance variable '@hash'</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Instance-Variable-Assumption.md" target="_blank"><b>InstanceVariableAssumption</b></a>        </span>      </div>      <span>Router::Client assumes too much for instance variable '@thr1'</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Instance-Variables.md" target="_blank"><b>TooManyInstanceVariables</b></a>        </span>      </div>      <span>Router::Client has at least 6 instance variables</span>          </div>  </li></ol>
    attr_reader :id, :hash, :config, :routing_table
    def initialize(id)
      @id = id
      @config = ReadConfig.new
      @routing_table = Table::RoutingTable.new(id)
      initialize_hash

      @thr_receive = receive_msg
      input
      @thr_receive.join
    end

    # Inicializa a hash
    # Ex:
    # {
    #   &#39;0&#39;: {}
    #   &#39;1&#39;: {}
    # }
    def initialize_hash
      @hash = {}
      hash_range = (@config.hash_size * @id)..(@config.hash_size * @id + @config.hash_size - 1)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#initialize_hash calls '@config.hash_size * @id' 2 times</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#initialize_hash calls '@config.hash_size' 3 times</span>          </div>  </li></ol>
      hash_range.each do |key|
        @hash[key.to_s.to_sym] = {}
      end
    end

    # Responsavel por enviar as mensagens, exibe mensagem de erro de conexao
    # se nao encontrar o servidor
    # send_router: roteador de onde partiu a mensagem
    # controller: variavel resposavel pelo tipo de mensagem
    # key: chave para ser salva ou buscada
    # value: mensagem a ser salva ou mensagem de retorno de uma busca
    def send_msg(send_router, controller, key, value)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flog/" target="_blank"><b>HighComplexity</b></a>        </span>      </div>      <span>Router::Client#send_msg has a flog score of 35</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Long-Parameter-List.md" target="_blank"><b>LongParameterList</b></a>        </span>      </div>      <span>Router::Client#send_msg has 4 parameters</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Router::Client#send_msg has approx 7 statements</span>          </div>  </li></ol>
      id = if controller == 2
             send_router.to_i
           else
             @routing_table.foresee_router(assemble_index(key).to_s)
           end
      ip = @config.routers[id.to_s.to_i][0]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls '@config.routers' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls '@config.routers[id.to_s.to_i]' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls 'id.to_s' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls 'id.to_s.to_i' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li></ol>
      port = @config.routers[id.to_s.to_i][1]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls '@config.routers' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls '@config.routers[id.to_s.to_i]' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls 'id.to_s' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#send_msg calls 'id.to_s.to_i' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L51" class="js-smell-location">0</a>                  <a href="client.html#L52" class="js-smell-location">1</a>                  </div>  </li></ol>
      TCPSocket.open(ip, port) do |server|
        server.write [
          send_router,
          controller,
          key.ljust(10),
          value.ljust(30)
        ].pack(&#39;LLA10A30&#39;)
      end
    rescue Errno::ECONNREFUSED
      puts &#39;Impossível se conectar com o servidor!&#39;
    end

    # Responsavel por receber as mensagens
    def receive_msg<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flog/" target="_blank"><b>HighComplexity</b></a>        </span>      </div>      <span>Router::Client#receive_msg has a flog score of 33</span>          </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Router::Client#receive_msg has approx 13 statements</span>          </div>  </li></ol>
      @thr1 = Thread.new do<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Uncommunicative-Variable-Name.md" target="_blank"><b>UncommunicativeVariableName</b></a>        </span>      </div>      <span>Router::Client has the variable name '@thr1'</span>          </div>  </li></ol>
        ip = @config.routers[@id][0]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#receive_msg calls '@config.routers' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L68" class="js-smell-location">0</a>                  <a href="client.html#L69" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#receive_msg calls '@config.routers[@id]' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L68" class="js-smell-location">0</a>                  <a href="client.html#L69" class="js-smell-location">1</a>                  </div>  </li></ol>
        port = @config.routers[@id][1]<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#receive_msg calls '@config.routers' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L68" class="js-smell-location">0</a>                  <a href="client.html#L69" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#receive_msg calls '@config.routers[@id]' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L68" class="js-smell-location">0</a>                  <a href="client.html#L69" class="js-smell-location">1</a>                  </div>  </li></ol>
        TCPServer.open(ip, port) do |server|
          loop do
            con = server.accept
            rst = con.recv(1024).unpack(&#39;LLA10A30&#39;)
            send_router = rst[0]
            controller = rst[1]
            key = rst[2]
            value = rst[3]
            unpack_message(send_router, controller, key, value)
            con.close
          end
        end
      end
    end

    # Verifica se a mensagem e de busca, armazenamento ou exibicao
    # 0: salvar mensagem
    # 1: buscar por chave
    # 2: exibir/enviar mensagem buscada
    def unpack_message(send_router, controller, key, value)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Long-Parameter-List.md" target="_blank"><b>LongParameterList</b></a>        </span>      </div>      <span>Router::Client#unpack_message has 4 parameters</span>          </div>  </li></ol>
      if controller.to_i.zero?
        assemble_hash(key, value)
      elsif controller == 1
        find_key(send_router, key)
      elsif controller == 2
        show_key_value(send_router, value)
      end
    end

    # Fica esperando o usuario escolher uma opcao
    # Menu
    # [1] Escrever mensagem
    # [2] Procurar chave
    # [3] Mostar Hash
    # [0] Sair
    def input<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Router::Client#input has approx 10 statements</span>          </div>  </li></ol>
      loop do
        menu
        op = $stdin.gets.chomp
        case op
        when &#39;0&#39;
          kill_threads
          break
        when &#39;1&#39;
          read_msg
        when &#39;2&#39;
          read_key
        when &#39;3&#39;
          show_hash
        when &#39;4&#39;
          @routing_table.print_table(@id)
        else
          puts &#39;Informe apenas uma das opções acima!&#39;
        end
      end
    end

    # Le a chave e a mensagem que sera salva
    def read_msg
      puts &#39;Informe a chave: &#39;
      key = $stdin.gets.chomp<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#read_msg calls '$stdin.gets' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L130" class="js-smell-location">0</a>                  <a href="client.html#L132" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#read_msg calls '$stdin.gets.chomp' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L130" class="js-smell-location">0</a>                  <a href="client.html#L132" class="js-smell-location">1</a>                  </div>  </li></ol>
      puts &#39;Informe a mensagem:&#39;
      msg = $stdin.gets.chomp<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#read_msg calls '$stdin.gets' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L130" class="js-smell-location">0</a>                  <a href="client.html#L132" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#read_msg calls '$stdin.gets.chomp' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L130" class="js-smell-location">0</a>                  <a href="client.html#L132" class="js-smell-location">1</a>                  </div>  </li></ol>
      assemble_hash(key, msg)
    end

    # Encontra o hash para a chave
    def assemble_index(key)
      (key.to_i % (@config.routers.size * @config.hash_size)).to_s.to_sym
    end

    # Armazena os dados se a chave faz parte da hash do cliente
    # senao manda os dados para outro cliente
    def assemble_hash(key, msg)
      index = assemble_index(key)

      if @hash.key? index
        @hash[index][key.to_s.to_sym] = msg
      else
        send_msg(@id, 0, key, msg)
      end
    end

    # Le a chave que sera buscada
    def read_key
      puts &#39;Informe a chave: &#39;
      key = $stdin.gets.chomp
      find_key(@id, key)
    end

    # Procura a chave no proprio hash
    # senao encontrar busca em outros clientes
    def find_key(send_router, key)<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="http://docs.seattlerb.org/flog/" target="_blank"><b>HighComplexity</b></a>        </span>      </div>      <span>Router::Client#find_key has a flog score of 29</span>          </div>  </li></ol>
      index = assemble_index(key)

      if @hash.key? index
        if @hash[index].key? key.to_s.to_sym<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#find_key calls '@hash[index]' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L166" class="js-smell-location">0</a>                  <a href="client.html#L167" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#find_key calls 'key.to_s' 3 times</span>              <span>Locations:</span>                  <a href="client.html#L166" class="js-smell-location">0</a>                  <a href="client.html#L167" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#find_key calls 'key.to_s.to_sym' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L166" class="js-smell-location">0</a>                  <a href="client.html#L167" class="js-smell-location">1</a>                  </div>  </li></ol>
          msg = &quot;Chave: &quot; + key.to_s + &#39;    Valor: &#39; + @hash[index][key.to_s.to_sym].to_s<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#find_key calls '@hash[index]' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L166" class="js-smell-location">0</a>                  <a href="client.html#L167" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#find_key calls 'key.to_s' 3 times</span>              <span>Locations:</span>                  <a href="client.html#L166" class="js-smell-location">0</a>                  <a href="client.html#L167" class="js-smell-location">1</a>                  </div>  </li>  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#find_key calls 'key.to_s.to_sym' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L166" class="js-smell-location">0</a>                  <a href="client.html#L167" class="js-smell-location">1</a>                  </div>  </li></ol>
          show_key_value(send_router, msg)
        else
          show_key_value(send_router, &#39;Está chave não existe!&#39;)
        end
      else
        # Mandar buscar em outros hashs
        send_msg(send_router, 1, key, &#39;&#39;)
      end
    end

    # Exibe a mensagem se ele mesmo requisitou a chave
    # senao manda para o cliente que a requisitou
    def show_key_value(send_router, msg)
      if send_router.to_i == @id
        print &quot;\n&quot; + msg
      else
        send_msg(send_router, 2, &#39;&#39;, msg)
      end
    end

    def menu<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Router::Client#menu has approx 8 statements</span>          </div>  </li></ol>
      sleep(1)
      puts &quot;\nCliente [#{@id}]&quot;
      puts &#39;-------------- OPÇÕES --------------&#39;
      puts &#39;[1] Escrever mensagem&#39;
      puts &#39;[2] Procurar chave&#39;
      puts &#39;[3] Mostar Hash&#39;
      puts &#39;[0] Sair&#39;
      print &#39;-&gt; &#39;
    end

    def kill_threads
      Thread.kill(@thr1)
    end

    def show_hash<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Too-Many-Statements.md" target="_blank"><b>TooManyStatements</b></a>        </span>      </div>      <span>Router::Client#show_hash has approx 7 statements</span>          </div>  </li></ol>
      puts &#39;------------------------------------&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#show_hash calls 'puts '------------------------------------'' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L204" class="js-smell-location">0</a>                  <a href="client.html#L212" class="js-smell-location">1</a>                  </div>  </li></ol>
      @hash.each do |key, sub_hash|
        puts key.to_s + &#39;:&#39;
        sub_hash.each do |sub_key, value|<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Nested-Iterators.md" target="_blank"><b>NestedIterators</b></a>        </span>      </div>      <span>Router::Client#show_hash contains iterators nested 2 deep</span>          </div>  </li></ol>
          puts &#39;  &#39; + sub_key.to_s + &#39;: &#39; + value.to_s
        end
        puts &#39;&#39;
      end
      puts &#39;------------------------------------&#39;<ol class="nocode errors smells">  <li>    <div class="description">      <div class="heading">        <span>          <i class="fa fa-warning" aria-hidden"true"=""></i>          <a href="https://github.com/troessner/reek/blob/master/docs/Duplicate-Method-Call.md" target="_blank"><b>DuplicateMethodCall</b></a>        </span>      </div>      <span>Router::Client#show_hash calls 'puts '------------------------------------'' 2 times</span>              <span>Locations:</span>                  <a href="client.html#L204" class="js-smell-location">0</a>                  <a href="client.html#L212" class="js-smell-location">1</a>                  </div>  </li></ol>
    end
  end
end

if ARGV.length != 1
  puts &#39;Informe o ID do roteador!&#39;
  exit
end

id = ARGV[0].to_i

# Instancia o cliente com seu id
Router::Client.new(id)
</code>
  </div>
</div>

        </div>
      </div>
    </div>

    <!-- Javascripts -->
    <script src='assets/javascripts/jquery.min.js'></script>
    <script src='assets/javascripts/jquery.tablesorter.min.js'></script>
    <script src='assets/javascripts/jquery.scrollTo.min.js'></script>
    <script src='assets/javascripts/jquery.timeago.js'></script>
    <script src='assets/javascripts/highcharts.src-4.0.1.js'></script>
    <script src='assets/javascripts/prettify.js'></script>
    <script src='assets/javascripts/bootstrap.min.js'></script>
    <script src='assets/javascripts/application.js'></script>
    <script src='assets/javascripts/jquery.filtertable.min.js'></script>
  </body>
</html>
